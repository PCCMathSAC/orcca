<?xml version="1.0" encoding="UTF-8" ?>
<!-- *********************************************************************-->
<!-- Copyright 2016-2018                                                  -->
<!-- Portland Community College                                           -->
<!--                                                                      -->
<!-- This file is part of Open Resources for Community College Algebra    -->
<!-- (ORCCA).                                                             -->
<!-- *********************************************************************-->
<section permid="yuI" xml:id="section-combining-like-terms">
  <title>Combining Like Terms</title>
  <objectives permid="tpq">
    <title>PCC Course Content and Outcome Guide</title>
    <ul permid="agt">
      <li permid="JSc">
        <xref ref="mth60-simplify-algebraic-expressions" />
      </li>
    </ul>
  </objectives>

  <introduction permid="Zwz">
    <p permid="yXL">
      In the last section we worked with algebraic expressions.
      In order to simplify algebraic expressions,
      it is useful to identify which quantities we can combine.
    </p>

    <figure permid="feU">
      <caption>Alternative Video Lesson</caption>
      <video youtubeplaylist="PLmuZCPhWPt-cBctr6w6PJujrhmaMydHzL" />
    </figure>
  </introduction>

  <subsection permid="eBR">
    <title>Identifying Terms</title>
    <p permid="QFQ">
      In an algebraic expression, the <term>terms</term>
          <idx><h>term</h></idx>
      are the quantities that are added.
      For example, the expression <m>3x+2y</m> has two terms,
      which are <m>3x</m> and <m>2y</m>.
      The <term>coefficient</term> or
      <term>numerical coefficient</term>
          <idx><h>coefficient</h></idx>
      of a term is the number attached to the variable, by multiplication.
    </p>

    <example permid="PsT">
      <statement>
        <p permid="BSr">
          List the terms in the expression <m>2l+2w</m>.
        </p>
      </statement>
      <solution permid="FDI">
        <p permid="CXK">
          The expression has two terms that are being added, <m>2l</m> and <m>2w</m>.
        </p>
      </solution>
    </example>

    <p permid="wMZ">
      If there is any subtraction, we will rewrite the expression using addition.
      Here is an example of that.
    </p>

    <example permid="vAc">
      <statement>
        <p permid="hZA">
          List the terms in the expression <m>-3x^2+5x-4</m>.
        </p>
      </statement>
      <solution permid="lKR">
        <p permid="jeT">
          We can rewrite this expression as
          <m>-3x^2+5x+(-4)</m> to see that the terms are <m>-3x^2</m>,
          <m>5x</m>,
          and <m>-4</m>.
          The last term is negative because subtracting is the same as adding the opposite.
        </p>
      </solution>
    </example>

    <example permid="bHl">
      <statement>
        <p permid="OgJ">
          List the terms in the expression <m>3\,\text{cm}+2\,\text{cm}+3\,\text{cm}+2\,\text{cm}</m>.
        </p>
      </statement>
      <solution permid="RSa">
        <p permid="Pmc">
          This expression has four terms:
          <quantity><mag>3</mag><unit base="meter" prefix="centi"/></quantity>,
          <quantity><mag>2</mag><unit base="meter" prefix="centi"/></quantity>,
          <quantity><mag>3</mag><unit base="meter" prefix="centi"/></quantity>, and
          <quantity><mag>2</mag><unit base="meter" prefix="centi"/></quantity>.
        </p>
      </solution>
    </example>

    <exercise permid="HOu">
      <webwork>
          <setup>

            <pg-code>
                Context("Numeric");
                Context()->variables->are(x=>'Real',z=>'Real');
                $terms = List("5x, -4x, 10z");
            </pg-code>
          </setup>
          <statement>
            <p permid="Lmd">
              List the terms in the expression <m>5x-4x+10z</m>.
            </p>
            <instruction>
              Enter the terms separated by commas.
            </instruction>
            <p permid="rtm">
              <var name="$terms" width="15" />
            </p>
          </statement>
          <solution permid="CJc">
            <p permid="vtl">
              The terms are <m>5x</m>, <m>-4x</m>, and <m>10z</m>.
            </p>
          </solution>
      </webwork>
    </exercise>
  </subsection>
<!--TODO: Alex, if time: add a visual introduction/explanation of how feet and square feet cannot combine-->
  <subsection permid="KJa">
    <title>Combining Like Terms</title>
    <p permid="cUi">
      In the examples above, you may have wanted to combine some of the terms.
      Look at the quantities below to see which ones you can add or subtract.

      <ol permid="xDK" label="a." cols="3">
        <li permid="pZl">
          <p permid="Qke">
            <m>5\,\text{in}+20\,\text{in}</m>
          </p>
        </li>

        <li permid="Wgu">
          <p permid="wrn">
            <m>16\,\text{ft}-4\,\text{ft}^2</m>
          </p>
        </li>

        <li permid="CnD">
          <p permid="cyw">
            <m>2\,\apple+5\,\apple</m>
          </p>
        </li>

        <li permid="iuM">
          <p permid="IFF">
            <m>5\,\text{min}+50\,\text{ft}</m>
          </p>
        </li>

        <li permid="OBV">
          <p permid="oMO">
            <m>5\,\dog-2\,\cat</m>
          </p>
        </li>

        <li permid="uJe">
          <p permid="UTX">
            <m>20\,\text{m}-6\,\text{m}</m>
          </p>
        </li>
      </ol>
    </p>

    <p permid="Jbr">
      The terms that we can combine are called <term>like terms</term>.
          <idx><h>like term</h></idx>
      We can combine terms with the same units,
      but we cannot combine units such as minutes and feet or cats and dogs.
      We can combine the like terms by combining their coefficients.
      Here are the answers:

      <ol permid="dKT" label="a." cols="3">
        <li permid="aQn">
          <p permid="Bbg">
            <m>5\,\text{in}+20\,\text{in}=25\,\text{in}</m>
          </p>
        </li>

        <li permid="GXw">
          <p permid="hip">
            <m>16\,\text{ft}-4\,\text{ft}^2</m> cannot be simplified
          </p>
        </li>

        <li permid="neF">
          <p permid="Npy">
            <m>2\,\apple+5\,\apple=7\,\apple</m>
          </p>
        </li>

        <li permid="TlO">
          <p permid="twH">
            <m>5\,\text{min}+50\,\text{ft}</m> cannot be simplified
          </p>
        </li>

        <li permid="zsX">
          <p permid="ZDQ">
            <m>5\,\dog-2\,\cat</m> cannot be simplified
          </p>
        </li>

        <li permid="LHp">
          <p permid="FKZ">
            <m>20\,\text{m}-6\,\text{m}=14\,\text{min}</m>
          </p>
        </li>
      </ol>
    </p>

    <p permid="piA">
<!--Note that we could combine units such as feet and inches if we convert one of the terms first. -->Now let's look at some examples that have variables in them.
    </p>

    <exercise permid="sFw">
      <webwork>
          <setup>

            <pg-code>
                $can = PopUp(['?','can','cannot'],1);
                $cannot = PopUp(['?','can','cannot'],2);
            </pg-code>
          </setup>
          <statement>
            <p permid="XAv">
              Which expressions have like terms that you can combine?

              <ol permid="GnC" cols="2">
                <li permid="rOy">
                  <p permid="lSi">
                    <m>10x+3y</m> <var name="$cannot" form="popup" /> be combined.
                  </p>
                </li>

                <li permid="XVH">
                  <p permid="RZr">
                    <m>4x-8x</m> <var name="$can" form="popup" /> be combined.
                  </p>
                </li>

                <li permid="EcQ">
                  <p permid="ygA">
                    <m>9y-4y</m> <var name="$can" form="popup" /> be combined.
                  </p>
                </li>

                <li permid="kjZ">
                  <p permid="enJ">
                    <m>-6x+17z</m> <var name="$cannot" form="popup" /> be combined.
                  </p>
                </li>

                <li permid="Qri">
                  <p permid="KuS">
                    <m>-3x-7x</m> <var name="$can" form="popup" /> be combined.
                  </p>
                </li>

                <li permid="wyr">
                  <p permid="qCb">
                    <m>5t+8t^2</m> <var name="$cannot" form="popup" /> be combined.
                  </p>
                </li>
              </ol>
            </p>
          </statement>
          <solution permid="iQl">
            <p permid="bAu">
              The terms that we can combine have the same variable part,
              including any exponents.

              <ol permid="Eyp" cols="2">
                <li permid="cFA">
                  <p permid="WJk">
                    <m>10x+3y</m> cannot be combined.
                  </p>
                </li>

                <li permid="IMJ">
                  <p permid="CQt">
                    <m>4x-8x=-4x</m>
                  </p>
                </li>

                <li permid="oTS">
                  <p permid="iXC">
                    <m>9y-4y=5y</m>
                  </p>
                </li>

                <li permid="Vbb">
                  <p permid="PeL">
                    <m>-6x+17z</m> cannot be combined.
                  </p>
                </li>

                <li permid="Bik">
                  <p permid="vlU">
                    <m>-3x-7x=-10x</m>
                  </p>
                </li>

                <li permid="hpt">
                  <p permid="btd">
                    <m>5t+8t^2</m> cannot be combined.
                  </p>
                </li>
              </ol>
            </p>
          </solution>
      </webwork>
    </exercise>

    <example permid="nVD">
      <statement>
        <p permid="unS">
          Simplify the expression <m>20x-16x+4y</m>,
          if possible, by combining like terms.
        </p>
      </statement>
      <solution permid="xZj">
        <p permid="HHD">
          This expression has two like terms,
          <m>20x</m> and <m>-16x</m>, which we can combine.
          <me permid="hEb">
            20x-16x+4y=4x+4y
          </me>
          Note that we cannot combine <m>4x</m> and <m>4y</m> because <m>x</m> and <m>y</m> represent different quantities.
        </p>
      </solution>
    </example>

    <example permid="UcM">
      <statement>
        <p permid="avb">
          Simplify the expression <m>100x+100x^2</m>,
          if possible, by combining like terms.
        </p>
      </statement>
      <solution permid="egs">
        <p permid="nOM">
          This expression cannot be simplified because the variable parts are not the same.
          We cannot add <m>x</m> and <m>x^2</m> just like we cannot add feet,
          a measure of length, and square feet, a measure of area.
        </p>
      </solution>
    </example>

    <example permid="AjV">
      <statement>
        <p permid="GCk">
          Simplify the expression <m>-10r+2s-5t</m>,
          if possible, by combining like terms.
        </p>
      </statement>
      <solution permid="KnB">
        <p permid="TVV">
          This expression cannot be simplified because there are not any like terms.
        </p>
      </solution>
    </example>

    <example permid="gre">
      <statement>
        <p permid="mJt">
          Simplify the expression <m>y+5y</m>,
          if possible, by combining like terms.
        </p>
      </statement>
      <solution permid="quK">
        <p permid="Ade">
          This expression can be thought of as <m>1y+5y</m>.
          When we have a single <m>y</m>,
          the coefficient of <m>1</m> is not usually written.
          Now we have two like terms, <m>1y</m> and <m>5y</m>.
          We will add those together:
          <md permid="NLk">
            <mrow>x+5x\amp= 1x+5x</mrow>
            <mrow>\amp=6x</mrow>
          </md>
        </p>
      </solution>
    </example>

    <p permid="VpJ">
      So far we have combined terms with whole numbers and integers,
      but we can also combine like terms when the coefficients are decimals
      (or fractions).
    </p>

    <example permid="Myn">
      <statement>
        <p permid="SQC">
          Simplify the expression <m>x-0.15x</m>,
          if possible, by combining like terms.
        </p>
      </statement>
      <solution permid="WBT">
        <p permid="gkn">
          Note that this expression can be rewritten as
          <m>1.00x-0.15x</m>, and combined like this:
          <md permid="tSt">
            <mrow>x-0.15x\amp=1.00x-0.15x</mrow>
            <mrow>\amp=0.85x</mrow>
          </md>
        </p>
      </solution>
    </example>

    <exercise permid="YMF">
      <webwork>
          <setup>

            <pg-code>
                    Context("Numeric");
                    Context()->noreduce('(-x)+y','(-x)-y');
                    Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                    Context()->operators->set(
                        '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                        '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                    );
                    $ans[0]=Formula("14x-7y");
                    $ans[1]=Formula("-7y+2x^2");
                    $ans[2]=Formula("1.25x");
                    $ans[3]=Formula("4x+1.5y-9z");
                    for $i (0..3) {
                        $evaluator[$i] = $ans[$i] -> cmp(
                           checker=>sub{
                              my ( $correct, $student, $ansHash ) = @_;
                              return 0 if $ansHash->{isPreview} || $correct != $student;
                              $student = $ansHash->{student_formula};
                              $correct = $correct->{original_formula} if defined $correct->{original_formula};
                              $student = Formula("$student"); $correct = Formula("$correct");
                              return 0 unless ($correct == $student);
                              Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                              delete $correct->{test_values}, $student->{test_values};
                              my $OK = (($correct == $student) or ($student == $correct));
                              Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                              Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                              return $OK;
                        });
                    }
            </pg-code>
          </setup>
          <statement>
            <p permid="DHE">
              Simplify each expression, if possible, by combining like terms.
            </p>
            <instruction>
              If the expression cannot be simplified further, just enter it as it is.
            </instruction>
            <p permid="jON">
              <ol permid="muL" label="a." cols="2">
                <li permid="NwC">
                  <p permid="HAm">
                    <m>4x-7y+10x</m>
                  </p>

                  <p permid="nHv">
                    <var name="$evaluator[0]" width="25" />
                  </p>
                </li>

                <li permid="tDL">
                  <p permid="TOE">
                    <m>y-8y+2x^2</m>
                  </p>

                  <p permid="zVN">
                    <var name="$evaluator[1]" width="25" />
                  </p>
                </li>

                <li permid="ZKU">
                  <p permid="gcW">
                    <m>x+0.25x</m>
                  </p>

                  <p permid="Mkf">
                    <var name="$evaluator[2]" width="25" />
                  </p>
                </li>

                <li permid="FSd">
                  <p permid="sro">
                    <m>4x+1.5y-9z</m>
                  </p>

                  <p permid="Yyx">
                    <var name="$evaluator[3]" width="25" />
                  </p>
                </li>
              </ol>
            </p>
          </statement>
          <solution permid="OXu">
            <p permid="Mrw">
              <ol permid="kFy" label="a.">
                <li permid="lZm">
                  <p permid="EFG">
                    This expression has two like terms that can be combined to get <m>14x-7y</m>.
                  </p>
                </li>

                <li permid="Sgv">
                  <p permid="kMP">
                    In this expression we can combine the <m>y</m> terms to get <m>-7y+2x^2</m>.
                  </p>
                </li>

                <li permid="ynE">
                  <p permid="QTY">
                    Rewrite this expression as
                    <m>1.00x+0.25x</m> and simplify to get <m>1.25x</m>.
                  </p>
                </li>

                <li permid="euN">
                  <p permid="xbh">
                    This expression cannot be simplified further because there are not any like terms.
                  </p>
                </li>
              </ol>
            </p>
          </solution>
      </webwork>
    </exercise>

    <remark>
      <title>The Difference Between Terms and Factors</title>
      <p permid="BwS">
        We have learned that terms are quantities that are added,
        such as <m>3x</m> and <m>-2x</m> in <m>3x-2x</m>.
        These are different than <term>factors</term>,
            <idx><h>factor</h></idx>
        which are parts that are multiplied together.
        For example, the term <m>2x</m> has two factors:
        <m>2</m> and <m>x</m>
        (with the multiplication symbol implied between them).
        The term <m>2\pi r</m> has three factors:
        <m>2</m>, <m>\pi</m>, and <m>r</m>.
      </p>
    </remark>
  </subsection>

  <exercises permid="qQj">
    <exercisegroup permid="WXs" cols="3">
      <title>Review and Warmup</title>
      <exercise permid="ETO">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/AdditionWithNegativeNumbers20.pg"  />
      </exercise>

      <exercise permid="laX">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/AdditionWithNegativeNumbers20.pg"  />
      </exercise>

      <exercise permid="Rig">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/AdditionWithNegativeNumbers30.pg"  />
      </exercise>

      <exercise permid="xpp">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/AdditionWithNegativeNumbers30.pg"  />
      </exercise>

      <exercise permid="dwy">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/SubtractionWithNegativeNumbers10.pg"  />
      </exercise>

      <exercise permid="JDH">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/SubtractionWithNegativeNumbers10.pg"  />
      </exercise>

      <exercise permid="pKQ">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/SubtractionWithNegativeNumbers20.pg"  />
      </exercise>

      <exercise permid="VRZ">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/SubtractionWithNegativeNumbers20.pg"  />
      </exercise>

      <exercise permid="BZi">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/SubtractionWithNegativeNumbers30.pg"  />
      </exercise>

      <exercise permid="igr">
        <webwork source="BasicAlgebra/SignedNumbersArithemtic/SubtractionWithNegativeNumbers30.pg"  />
      </exercise>

    </exercisegroup>
    <exercisegroup permid="DeB" cols="3">
      <title>Identifying Terms</title>
      <exercise permid="OnA">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @answer = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$answer[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="PVW">
                Count the number of terms in each expression.

                <ol permid="SBU" label="a.">
                  <li permid="KBW">
                    <p permid="diq">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="Jpz">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="qJf">
                    <p permid="pwI">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="VDR">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="WQo">
                    <p permid="BLa">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="hSj">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="CXx">
                    <p permid="NZs">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="ugB">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="veD">
              <p permid="syF">
                <ol permid="QMH" label="a.">
                  <li permid="jeG">
                    <p permid="anK">
                      This expression has <m><var name="$answers[0]" /></m> terms.
                    </p>
                  </li>

                  <li permid="PlP">
                    <p permid="GuT">
                      This expression has <m><var name="$answers[1]" /></m> terms.
                    </p>
                  </li>

                  <li permid="vsY">
                    <p permid="mCc">
                      This expression has <m><var name="$answers[2]" /></m> terms.
                    </p>
                  </li>

                  <li permid="bAh">
                    <p permid="SJl">
                      This expression has <m><var name="$answers[3]" /></m> terms.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>

      <exercise permid="uuJ">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @answer = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$answer[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="wdf">
                Count the number of terms in each expression.

                <ol permid="yJd" label="a.">
                  <li permid="HHq">
                    <p permid="yQu">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="eXD">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="nOz">
                    <p permid="LeM">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="rlV">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="TVI">
                    <p permid="Xte">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="DAn">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="AcR">
                    <p permid="jHw">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="POF">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="blM">
              <p permid="YFO">
                <ol permid="wTQ" label="a.">
                  <li permid="gka">
                    <p permid="vVO">
                      This expression has <m><var name="$answers[0]" /></m> terms.
                    </p>
                  </li>

                  <li permid="Mrj">
                    <p permid="ccX">
                      This expression has <m><var name="$answers[1]" /></m> terms.
                    </p>
                  </li>

                  <li permid="sys">
                    <p permid="Ikg">
                      This expression has <m><var name="$answers[2]" /></m> terms.
                    </p>
                  </li>

                  <li permid="YFB">
                    <p permid="orp">
                      This expression has <m><var name="$answers[3]" /></m> terms.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>
            <!-- decimal coefficients -->
      <exercise permid="aBS">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @answer = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$answer[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,0.1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="cko">
                Count the number of terms in each expression.

                <ol permid="eQm" label="a.">
                  <li permid="EMK">
                    <p permid="Uyy">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="AFH">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="kTT">
                    <p permid="gMQ">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="MTZ">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="Rbc">
                    <p permid="tbi">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="Zir">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="xil">
                    <p permid="FpA">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="lwJ">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="HsV">
              <p permid="EMX">
                <ol permid="daZ" label="a.">
                  <li permid="dpu">
                    <p permid="RDS">
                      This expression has <m><var name="$answers[0]" /></m> terms.
                    </p>
                  </li>

                  <li permid="JwD">
                    <p permid="xLb">
                      This expression has <m><var name="$answers[1]" /></m> terms.
                    </p>
                  </li>

                  <li permid="pDM">
                    <p permid="dSk">
                      This expression has <m><var name="$answers[2]" /></m> terms.
                    </p>
                  </li>

                  <li permid="VKV">
                    <p permid="JZt">
                      This expression has <m><var name="$answers[3]" /></m> terms.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>

      <exercise permid="GJb">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @answer = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$answer[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,0.1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="Irx">
                Count the number of terms in each expression.

                <ol permid="KXv" label="a.">
                  <li permid="BSe">
                    <p permid="qgC">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="WnL">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="hZn">
                    <p permid="CuU">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="iCd">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="Ogw">
                    <p permid="OJm">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="uQv">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>

                  <li permid="unF">
                    <p permid="aXE">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="HeN">
                      <var name="$answer[d]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="nAe">
              <p permid="kUg">
                <ol permid="Jii" label="a.">
                  <li permid="auO">
                    <p permid="nlW">
                      This expression has <m><var name="$answers[0]" /></m> terms.
                    </p>
                  </li>

                  <li permid="GBX">
                    <p permid="Ttf">
                      This expression has <m><var name="$answers[1]" /></m> terms.
                    </p>
                  </li>

                  <li permid="mJg">
                    <p permid="zAo">
                      This expression has <m><var name="$answers[2]" /></m> terms.
                    </p>
                  </li>

                  <li permid="SQp">
                    <p permid="fHx">
                      This expression has <m><var name="$answers[3]" /></m> terms.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>
            <!-- List terms -->
      <exercise permid="mQk">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @termcount = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    $answers[$i] = List();
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                        $answers[$i] = List($answers[$i]->value,Formula("$string")->reduce->reduce);
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="oyG">
                List the terms in each expression.

                <ol permid="reE" label="a.">
                  <li permid="yXy">
                    <p permid="LOG">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="rVP">
                      <var name="$answers[0]" width="25" />
                    </p>
                  </li>

                  <li permid="feH">
                    <p permid="YcY">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="Ekh">
                      <var name="$answers[1]" width="25" />
                    </p>
                  </li>

                  <li permid="LlQ">
                    <p permid="krq">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="Qyz">
                      <var name="$answers[2]" width="25" />
                    </p>
                  </li>

                  <li permid="rsZ">
                    <p permid="wFI">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="cMR">
                      <var name="$answers[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="THn">
              <p permid="Rbp">
                <ol permid="ppr" label="a.">
                  <li permid="XAi">
                    <p permid="IUa">
                      The terms are <m><var name="$answers[0]" /></m>.
                    </p>
                  </li>

                  <li permid="DHr">
                    <p permid="pbj">
                      The terms are <m><var name="$answers[1]" /></m>.
                    </p>
                  </li>

                  <li permid="jOA">
                    <p permid="Vis">
                      The terms are <m><var name="$answers[2]" /></m>.
                    </p>
                  </li>

                  <li permid="PVJ">
                    <p permid="BpB">
                      The terms are <m><var name="$answers[3]" /></m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>

      <exercise permid="SXt">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @termcount = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    $answers[$i] = List();
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                        $answers[$i] = List($answers[$i]->value,Formula("$string")->reduce->reduce);
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="UFP">
                List the terms in each expression.

                <ol permid="XlN" label="a.">
                  <li permid="wcS">
                    <p permid="hwK">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="NDT">
                      <var name="$answers[0]" width="25" />
                    </p>
                  </li>

                  <li permid="ckb">
                    <p permid="tLc">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="ZSl">
                      <var name="$answers[1]" width="25" />
                    </p>
                  </li>

                  <li permid="Irk">
                    <p permid="FZu">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="mgD">
                      <var name="$answers[2]" width="25" />
                    </p>
                  </li>

                  <li permid="oyt">
                    <p permid="SnM">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="yuV">
                      <var name="$answers[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="zOw">
              <p permid="xiy">
                <ol permid="VwA" label="a.">
                  <li permid="UFC">
                    <p permid="eCe">
                      The terms are <m><var name="$answers[0]" /></m>.
                    </p>
                  </li>

                  <li permid="AML">
                    <p permid="KJn">
                      The terms are <m><var name="$answers[1]" /></m>.
                    </p>
                  </li>

                  <li permid="gTU">
                    <p permid="qQw">
                      The terms are <m><var name="$answers[2]" /></m>.
                    </p>
                  </li>

                  <li permid="Nbd">
                    <p permid="WXF">
                      The terms are <m><var name="$answers[3]" /></m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>
            <!-- decimal coefficients -->
      <exercise permid="zeC">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @termcount = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    $answers[$i] = List();
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,0.1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                        $answers[$i] = List($answers[$i]->value,Formula("$string")->reduce->reduce);
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="AMY">
                List the terms in each expression.

                <ol permid="DsW" label="a.">
                  <li permid="tim">
                    <p permid="DeO">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="jlX">
                      <var name="$answers[0]" width="25" />
                    </p>
                  </li>

                  <li permid="Zpv">
                    <p permid="Ptg">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="vAp">
                      <var name="$answers[1]" width="25" />
                    </p>
                  </li>

                  <li permid="FwE">
                    <p permid="bHy">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="HOH">
                      <var name="$answers[2]" width="25" />
                    </p>
                  </li>

                  <li permid="lDN">
                    <p permid="nVQ">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="UcZ">
                      <var name="$answers[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="fVF">
              <p permid="dpH">
                <ol permid="BDJ" label="a.">
                  <li permid="RKW">
                    <p permid="Aki">
                      The terms are <m><var name="$answers[0]" /></m>.
                    </p>
                  </li>

                  <li permid="xSf">
                    <p permid="grr">
                      The terms are <m><var name="$answers[1]" /></m>.
                    </p>
                  </li>

                  <li permid="dZo">
                    <p permid="MyA">
                      The terms are <m><var name="$answers[2]" /></m>.
                    </p>
                  </li>

                  <li permid="Kgx">
                    <p permid="sFJ">
                      The terms are <m><var name="$answers[3]" /></m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>

      <exercise permid="flL">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @termcount = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    $answers[$i] = List();
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,0.1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                        $answers[$i] = List($answers[$i]->value,Formula("$string")->reduce->reduce);
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="gUh">
                List the terms in each expression.

                <ol permid="jAf" label="a.">
                  <li permid="qnG">
                    <p permid="YMS">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="EUb">
                      <var name="$answers[0]" width="25" />
                    </p>
                  </li>

                  <li permid="WuP">
                    <p permid="lbk">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="Rit">
                      <var name="$answers[1]" width="25" />
                    </p>
                  </li>

                  <li permid="CBY">
                    <p permid="xpC">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="dwL">
                      <var name="$answers[2]" width="25" />
                    </p>
                  </li>

                  <li permid="iJh">
                    <p permid="JDU">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="pLd">
                      <var name="$answers[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="McO">
              <p permid="JwQ">
                <ol permid="hKS" label="a.">
                  <li permid="OQq">
                    <p permid="VSm">
                      The terms are <m><var name="$answers[0]" /></m>.
                    </p>
                  </li>

                  <li permid="uXz">
                    <p permid="BZv">
                      The terms are <m><var name="$answers[1]" /></m>.
                    </p>
                  </li>

                  <li permid="beI">
                    <p permid="igE">
                      The terms are <m><var name="$answers[2]" /></m>.
                    </p>
                  </li>

                  <li permid="HlR">
                    <p permid="OnN">
                      The terms are <m><var name="$answers[3]" /></m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>
            <!-- fraction coefficients -->
      <exercise permid="LsU">
        <webwork>
            <setup>

            <pg-code>
                Context("Fraction");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->flags->set(reduceConstants=>0);
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @termcount = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    $answers[$i] = List();
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = Fraction(non_zero_random(-9,9,1),non_zero_random(-9,9,1)).$vars[$j-1].'^'.$exps[$j-1];
                        $string = non_zero_random(-9,9,0.1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                        $answers[$i] = List($answers[$i]->value,Formula("$string")->reduce->reduce);
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="Nbq">
                List the terms in each expression.

                <ol permid="PHo" label="a.">
                  <li permid="nta">
                    <p permid="uuW">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="aCf">
                      <var name="$answers[0]" width="25" />
                    </p>
                  </li>

                  <li permid="TAj">
                    <p permid="GJo">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="mQx">
                      <var name="$answers[1]" width="25" />
                    </p>
                  </li>

                  <li permid="zHs">
                    <p permid="SXG">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="zeP">
                      <var name="$answers[2]" width="25" />
                    </p>
                  </li>

                  <li permid="fOB">
                    <p permid="flY">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="Lth">
                      <var name="$answers[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="sjX">
              <p permid="pDZ">
                <ol permid="NSb" label="a.">
                  <li permid="LVK">
                    <p permid="rAq">
                      The terms are <m><var name="$answers[0]" /></m>.
                    </p>
                  </li>

                  <li permid="scT">
                    <p permid="XHz">
                      The terms are <m><var name="$answers[1]" /></m>.
                    </p>
                  </li>

                  <li permid="Ykc">
                    <p permid="DOI">
                      The terms are <m><var name="$answers[2]" /></m>.
                    </p>
                  </li>

                  <li permid="Erl">
                    <p permid="jVR">
                      The terms are <m><var name="$answers[3]" /></m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>

      <exercise permid="rAd">
        <webwork>
            <setup>

            <pg-code>
                Context("Fraction");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->flags->set(reduceConstants=>0);
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                @termcount = (1,2,2,3,3,4,4)[NchooseK(7,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    $answers[$i] = List();
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random('x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = Fraction(non_zero_random(-9,9,1),non_zero_random(-9,9,1)).$vars[$j-1].'^'.$exps[$j-1];
                        $string = non_zero_random(-9,9,0.1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+ $string")->reduce->reduce;
                        $answers[$i] = List($answers[$i]->value,Formula("$string")->reduce->reduce);
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
            </pg-code>
            </setup>
            <statement>
              <p permid="tiz">
                List the terms in each expression.

                <ol permid="vOx" label="a.">
                  <li permid="kyu">
                    <p permid="Qda">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="wkj">
                      <var name="$answers[0]" width="25" />
                    </p>
                  </li>

                  <li permid="QFD">
                    <p permid="crs">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="IyB">
                      <var name="$answers[1]" width="25" />
                    </p>
                  </li>

                  <li permid="wMM">
                    <p permid="oFK">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="UMT">
                      <var name="$answers[2]" width="25" />
                    </p>
                  </li>

                  <li permid="cTV">
                    <p permid="AUc">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="hbl">
                      <var name="$answers[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
            <solution permid="Yrg">
              <p permid="VLi">
                <ol permid="tZk" label="a.">
                  <li permid="Jbe">
                    <p permid="Niu">
                      The terms are <m><var name="$answers[0]" /></m>.
                    </p>
                  </li>

                  <li permid="pin">
                    <p permid="tpD">
                      The terms are <m><var name="$answers[1]" /></m>.
                    </p>
                  </li>

                  <li permid="Vpw">
                    <p permid="ZwM">
                      The terms are <m><var name="$answers[2]" /></m>.
                    </p>
                  </li>

                  <li permid="BwF">
                    <p permid="FDV">
                      The terms are <m><var name="$answers[3]" /></m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
        </webwork>
      </exercise>

    </exercisegroup>
    <exercisegroup permid="jlK" cols="2">
      <title>Combining Like Terms</title>
            <!-- two terms only -->
      <exercise permid="XHm">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,2,2,2,2,2)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'+'.
                            $expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'x+'.
                            $expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'y+'.
                            $expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'z+'.
                            $expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'s+'.
                            $expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'t+'.
                            $expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2x^2+'.
                            $expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2y^2+'.
                            $expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2z^2+'.
                            $expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2s^2+'.
                            $expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="ZpI">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="FwR">
                <ol permid="bVG" label="a.">
                  <li permid="hDO">
                    <p permid="lLe">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="RSn">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="NKX">
                    <p permid="xZw">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="egF">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="tSg">
                    <p permid="KnO">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="quX">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="ZZp">
                    <p permid="WCg">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="CJp">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>

      <exercise permid="DOv">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,2,2,2,2,2)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'+'.
                            $expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'x+'.
                            $expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'y+'.
                            $expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'z+'.
                            $expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'s+'.
                            $expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'t+'.
                            $expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2x^2+'.
                            $expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2y^2+'.
                            $expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2z^2+'.
                            $expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2s^2+'.
                            $expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="lEa">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="RLj">
                <ol permid="IcP" label="a.">
                  <li permid="Ggy">
                    <p permid="iQy">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="OXH">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="mnH">
                    <p permid="veQ">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="blZ">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="SuQ">
                    <p permid="Hti">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="nAr">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="yBZ">
                    <p permid="THA">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="zOJ">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>
            <!-- 2 to 4 terms -->
      <exercise permid="jVE">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'+'.
                            $expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'x+'.
                            $expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'y+'.
                            $expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'z+'.
                            $expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'s+'.
                            $expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'t+'.
                            $expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2x^2+'.
                            $expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2y^2+'.
                            $expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2z^2+'.
                            $expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2s^2+'.
                            $expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="xSs">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="dZB">
                <ol permid="ojY" label="a.">
                  <li permid="eJi">
                    <p permid="fVS">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="Mdb">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="KQr">
                    <p permid="skk">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="Yrt">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="qXA">
                    <p permid="EyC">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="kFL">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="XeJ">
                    <p permid="QMU">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="wUd">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>

      <exercise permid="QcN">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'+'.
                            $expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'x+'.
                            $expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'y+'.
                            $expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'z+'.
                            $expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'s+'.
                            $expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'t+'.
                            $expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2x^2+'.
                            $expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2y^2+'.
                            $expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2z^2+'.
                            $expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2s^2+'.
                            $expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="KgK">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="qnT">
                <ol permid="Urh" label="a.">
                  <li permid="DlS">
                    <p permid="dbm">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="Jiv">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="jtb">
                    <p permid="ppE">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="VwN">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="PAk">
                    <p permid="BDW">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="hLf">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="vHt">
                    <p permid="NSo">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="tZx">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>
            <!-- with larger integer coefficients -->
      <exercise permid="wjW">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-99,99,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'+'.
                            $expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'x+'.
                            $expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'y+'.
                            $expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'z+'.
                            $expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'s+'.
                            $expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'t+'.
                            $expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2x^2+'.
                            $expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2y^2+'.
                            $expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2z^2+'.
                            $expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2s^2+'.
                            $expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="Wvc">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="CCl">
                <ol permid="Ayq" label="a.">
                  <li permid="bOC">
                    <p permid="agG">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="GnP">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="HVL">
                    <p permid="muY">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="SCh">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="ocU">
                    <p permid="yJq">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="eQz">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="Ukd">
                    <p permid="KXI">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="reR">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>

      <exercise permid="crf">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-99,99,1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'+'.
                            $expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'x+'.
                            $expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'y+'.
                            $expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'z+'.
                            $expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'s+'.
                            $expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'t+'.
                            $expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2x^2+'.
                            $expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2y^2+'.
                            $expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2z^2+'.
                            $expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2s^2+'.
                            $expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="iJu">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="OQD">
                <ol permid="gFz" label="a.">
                  <li permid="Arm">
                    <p permid="Xma">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="Dtj">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="gyv">
                    <p permid="jAs">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="PHB">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="MFE">
                    <p permid="vOK">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="bVT">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="sMN">
                    <p permid="Idc">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="okl">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>
            <!-- decimal coefficients -->
      <exercise permid="Iyo">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,0.1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'+'.
                            $expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'x+'.
                            $expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'y+'.
                            $expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'z+'.
                            $expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'s+'.
                            $expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'t+'.
                            $expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2x^2+'.
                            $expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2y^2+'.
                            $expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2z^2+'.
                            $expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2s^2+'.
                            $expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="uXM">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="beV">
                <ol permid="MMI" label="a.">
                  <li permid="YTW">
                    <p permid="Uru">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="AyD">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="Fbf">
                    <p permid="gFM">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="MMV">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="lio">
                    <p permid="sUe">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="Zbn">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="Rpx">
                    <p permid="Fiw">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="lpF">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>

      <exercise permid="oFx">
        <webwork>
            <setup>

            <pg-code>
                Context("Numeric");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = non_zero_random(-9,9,0.1).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'+'.
                            $expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'x+'.
                            $expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'y+'.
                            $expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'z+'.
                            $expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'s+'.
                            $expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'t+'.
                            $expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2x^2+'.
                            $expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2y^2+'.
                            $expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2z^2+'.
                            $expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2s^2+'.
                            $expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="Hme">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="ntn">
                <ol permid="sTR" label="a.">
                  <li permid="xwG">
                    <p permid="RwO">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="xDX">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="dDP">
                    <p permid="dLg">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="JSp">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="JKY">
                    <p permid="pZy">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="WgH">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="pSh">
                    <p permid="CnQ">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="iuZ">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>
            <!-- fraction coefficients -->
      <exercise permid="UMG">
        <webwork>
            <setup>

            <pg-code>
                Context("Fraction");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->flags->set(reduceConstants=>0);
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = Fraction(non_zero_random(-9,9,1),non_zero_random(-9,9,1)).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula(Fraction($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'+'.
                            Fraction($expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'x+'.
                            Fraction($expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'y+'.
                            Fraction($expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'z+'.
                            Fraction($expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'s+'.
                            Fraction($expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'t+'.
                            Fraction($expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2x^2+'.
                            Fraction($expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2y^2+'.
                            Fraction($expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2z^2+'.
                            Fraction($expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2s^2+'.
                            Fraction($expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="TAw">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="zHF">
                <ol permid="Zba" label="a.">
                  <li permid="VZq">
                    <p permid="OCi">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="uJr">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="Cgz">
                    <p permid="aQA">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="GXJ">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="inI">
                    <p permid="neS">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="Tmb">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="OuR">
                    <p permid="ztk">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="fAt">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>

      <exercise permid="ATP">
        <webwork>
            <setup>

            <pg-code>
                Context("Fraction");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->flags->set(reduceConstants=>0);
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = Fraction(non_zero_random(-9,9,1),non_zero_random(-9,9,1)).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula(Fraction($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'+'.
                            Fraction($expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'x+'.
                            Fraction($expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'y+'.
                            Fraction($expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'z+'.
                            Fraction($expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'s+'.
                            Fraction($expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'t+'.
                            Fraction($expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2x^2+'.
                            Fraction($expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2y^2+'.
                            Fraction($expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2z^2+'.
                            Fraction($expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2s^2+'.
                            Fraction($expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="fOO">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="LVX">
                <ol permid="Fij" label="a.">
                  <li permid="uCa">
                    <p permid="LHC">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="rOL">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="aJj">
                    <p permid="XVU">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="Edd">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="GQs">
                    <p permid="kkm">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="Qrv">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="mXB">
                    <p permid="wyE">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="cFN">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>

      <exercise permid="haY">
        <webwork>
            <setup>

            <pg-code>
                Context("Fraction");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->flags->set(reduceConstants=>0);
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = Fraction(non_zero_random(-9,9,1),non_zero_random(-9,9,1)).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula(Fraction($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'+'.
                            Fraction($expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'x+'.
                            Fraction($expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'y+'.
                            Fraction($expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'z+'.
                            Fraction($expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'s+'.
                            Fraction($expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'t+'.
                            Fraction($expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2x^2+'.
                            Fraction($expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2y^2+'.
                            Fraction($expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2z^2+'.
                            Fraction($expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2s^2+'.
                            Fraction($expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="sdg">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="Ykp">
                <ol permid="lps" label="a.">
                  <li permid="TeK">
                    <p permid="IMW">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="oUf">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="zlT">
                    <p permid="Vbo">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="Bix">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="ftc">
                    <p permid="hpG">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="NwP">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="LAl">
                    <p permid="tDY">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="ZLh">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>

      <exercise permid="Nih">
        <webwork>
            <setup>

            <pg-code>
                Context("Fraction");
                Context()->noreduce('(-x)+y','(-x)-y');
                Context()->flags->set(reduceConstants=>0);
                Context()->variables->are(x=>'Real',y=>'Real',z=>'Real',t=>'Real',s=>'Real');
                Context()->operators->set(
                    '+' => {class => 'bizarro::BOP::add', isCommand => 1},
                    '-' => {class => 'bizarro::BOP::subtract', isCommand => 1},
                );
                @termcount = (2,2,2,3,3,3,4,4)[NchooseK(8,4)];
                for $i (0..3) {
                    $expression[$i] = Formula("0");
                    my @vars;
                    my @exps;
                    for $j (1..$termcount[$i]) {
                        my $nextvar = list_random(@vars,@vars,@vars,'x','y','z','t','s');
                        my $nextexp;
                        do {$nextexp = list_random(@exps,@exps,@exps,0,1,1,1,2,2);} until ($exps[$j-2] != 0 or $nextexp != 0);
                        push(@vars,$nextvar);
                        push(@exps,$nextexp);
                        $string = Fraction(non_zero_random(-9,9,1),non_zero_random(-9,9,1)).$vars[$j-1].'^'.$exps[$j-1];
                        $expression[$i] = Compute("$expression[$i]+$string")->reduce->reduce;
                    }
                }
                $exp0=$expression[0];
                $exp1=$expression[1];
                $exp2=$expression[2];
                $exp3=$expression[3];
                for $i (0..3) {
                    $answers[$i] = Formula(Fraction($expression[$i]->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'+'.
                            Fraction($expression[$i]->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'x+'.
                            Fraction($expression[$i]->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'y+'.
                            Fraction($expression[$i]->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'z+'.
                            Fraction($expression[$i]->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'s+'.
                            Fraction($expression[$i]->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'t+'.
                            Fraction($expression[$i]->D('x')->D('x')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2x^2+'.
                            Fraction($expression[$i]->D('y')->D('y')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2y^2+'.
                            Fraction($expression[$i]->D('z')->D('z')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2z^2+'.
                            Fraction($expression[$i]->D('s')->D('s')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2s^2+'.
                            Fraction($expression[$i]->D('t')->D('t')->eval(x=>0,y=>0,z=>0,t=>0,s=>0)).'/2t^2')->reduce->reduce;
                    $evaluator[$i] = $answers[$i] -> cmp(
                       checker=>sub{
                          my ( $correct, $student, $ansHash ) = @_;
                          return 0 if $ansHash->{isPreview} || $correct != $student;
                          $student = $ansHash->{student_formula};
                          $correct = $correct->{original_formula} if defined $correct->{original_formula};
                          $student = Formula("$student"); $correct = Formula("$correct");
                          return 0 unless ($correct == $student);
                          Context()->flags->set(bizarroAdd=>1,bizarroSub=>1);
                          delete $correct->{test_values}, $student->{test_values};
                          my $OK = (($correct == $student) or ($student == $correct));
                          Context()->flags->set(bizarroAdd=>0,bizarroSub=>0);
                          Value::Error("Your answer is not in the expected form. It might not be fully simplified.") unless $OK;
                          return $OK;
                    });
                }
            </pg-code>
            </setup>
            <statement>
              <p permid="Ery">
                Simplify each expression, if possible, by combining like terms.
              </p>
              <instruction>
                If the expression cannot be simplified further, just enter it as it is.
              </instruction>
              <p permid="kyH">
                <ol permid="RwB" label="a.">
                  <li permid="rHu">
                    <p permid="FSq">
                      <m><var name="$exp0" /></m>
                    </p>

                    <p permid="lZz">
                      <var name="$evaluator[0]" width="25" />
                    </p>
                  </li>

                  <li permid="XOD">
                    <p permid="SgI">
                      <m><var name="$exp1" /></m>
                    </p>

                    <p permid="ynR">
                      <var name="$evaluator[1]" width="25" />
                    </p>
                  </li>

                  <li permid="DVM">
                    <p permid="eva">
                      <m><var name="$exp2" /></m>
                    </p>

                    <p permid="KCj">
                      <var name="$evaluator[2]" width="25" />
                    </p>
                  </li>

                  <li permid="kcV">
                    <p permid="qJs">
                      <m><var name="$exp3" /></m>
                    </p>

                    <p permid="WQB">
                      <var name="$evaluator[3]" width="25" />
                    </p>
                  </li>
                </ol>
              </p>
            </statement>
        </webwork>
      </exercise>

    </exercisegroup>
  </exercises>
</section>

